from libs.data_visualizer import *



file = "data/data.txt"


class parseFile:
	'''
	@this will parse the file for the cords and return a list of them
	:path :str  
	'''
	def __init__(self, path: str):
		self.path = path
		self.dataset = []

		with open(self.path, "r") as file:
			for x in file.read().split('|'):
				try:
					self.dataset.append(self.get_points_from_slice(x))
				except IndexError:
					pass

	def get_points_from_slice(self, slice: str):
		cord = slice.split(', ')
		return [cord[0], cord[1]]



#first thousand points
#dataset = [['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2491', '334'], ['2489', '334'], ['2486', '334'], ['2485', '334'], ['2482', '334'], ['2469', '332'], ['2428', '325'], ['2341', '301'], ['2257', '277'], ['2212', '263'], ['2161', '251'], ['2065', '224'], ['1983', '210'], ['1879', '190'], ['1693', '173'], ['1550', '154'], ['1351', '123'], ['1267', '111'], ['1118', '88'], ['1059', '79'], ['1003', '77'], ['962', '74'], ['932', '72'], ['900', '69'], ['887', '69'], ['873', '69'], ['864', '69'], ['856', '69'], ['852', '69'], ['850', '69'], ['849', '69'], ['849', '69'], ['848', '69'], ['844', '69'], ['840', '69'], ['831', '68'], ['819', '68'], ['805', '68'], ['777', '68'], ['755', '68'], ['732', '73'], ['719', '76'], ['696', '82'], ['679', '89'], ['650', '102'], ['650', '102'], ['596', '121'], ['565', '129'], ['565', '129'], ['517', '151'], ['517', '151'], ['501', '157'], ['486', '164'], ['482', '166'], ['482', '166'], ['481', '167'], ['480', '168'], ['479', '169'], ['479', '170'], ['479', '172'], ['478', '173'], ['478', '174'], ['478', '175'], ['478', '176'], ['477', '177'], ['476', '178'], ['475', '180'], ['474', '183'], ['474', '183'], ['474', '184'], ['474', '185'], ['474', '186'], ['474', '187'], ['474', '187'], ['473', '188'], ['473', '188'], ['473', '188'], ['473', '189'], ['473', '189'], ['473', '190'], ['473', '190'], ['473', '190'], ['473', '190'], ['473', '190'], ['473', '190'], ['473', '190'], ['473', '190'], ['473', '190'], ['472', '190'], ['472', '190'], ['472', '190'], ['471', '190'], ['471', '191'], ['471', '191'], ['471', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['470', '191'], ['469', '191'], ['469', '191'], ['469', '191'], ['468', '191'], ['468', '191'], ['468', '191'], ['467', '191'], ['467', '191'], ['467', '191'], ['467', '191'], ['467', '191'], ['467', '191'], ['467', '190'], ['467', '190'], ['467', '190'], ['467', '190'], ['467', '190'], ['467', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['466', '190'], ['469', '190'], ['474', '190'], ['483', '190'], ['490', '190'], ['490', '190'], ['521', '189'], ['521', '189'], ['542', '189'], ['561', '190'], ['599', '191'], ['625', '192'], ['664', '193'], ['685', '195'], ['700', '195'], ['709', '195'], ['715', '196'], ['722', '196'], ['726', '196'], ['730', '196'], ['732', '196'], ['735', '196'], ['738', '196'], ['742', '197'], ['743', '197'], ['744', '197'], ['745', '197'], ['745', '197'], ['745', '197'], ['746', '197'], ['746', '197'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['746', '196'], ['747', '196'], ['748', '197'], ['748', '197'], ['750', '197'], ['752', '197'], ['756', '196'], ['756', '196'], ['763', '197'], ['776', '199'], ['776', '199'], ['797', '202'], ['827', '202'], ['827', '202'], ['885', '203'], ['968', '206'], ['968', '206'], ['1053', '212'], ['1190', '232'], ['1190', '232'], ['1373', '263'], ['1501', '285'], ['1684', '324'], ['1887', '369'], ['2014', '396'], ['2135', '420'], ['2194', '431'], ['2194', '431'], ['2209', '432'], ['2209', '432'], ['2223', '433'], ['2241', '436'], ['2241', '436'], ['2261', '440'], ['2285', '447'], ['2310', '453'], ['2310', '453'], ['2325', '456'], ['2325', '456'], ['2331', '457'], ['2334', '457'], ['2334', '457'], ['2335', '458'], ['2335', '458'], ['2335', '458'], ['2335', '458'], ['2335', '458'], ['2335', '458'], ['2336', '459'], ['2339', '462'], ['2339', '462'], ['2347', '466'], ['2359', '474'], ['2359', '474'], ['2380', '484'], ['2402', '493'], ['2402', '493'], ['2421', '500'], ['2439', '508'], ['2439', '508'], ['2457', '514'], ['2471', '519'], ['2471', '519'], ['2481', '524'], ['2486', '526'], ['2487', '526'], ['2487', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2488', '526'], ['2487', '526'], ['2487', '526'], ['2486', '526'], ['2486', '525'], ['2485', '525'], ['2484', '525'], ['2482', '524'], ['2478', '522'], ['2467', '517'], ['2454', '512'], ['2439', '504'], ['2430', '502'], ['2415', '497'], ['2411', '494'], ['2389', '484'], ['2370', '477'], ['2323', '461'], ['2275', '447'], ['2161', '416'], ['2074', '383'], ['2016', '358'], ['1938', '317'], ['1818', '258'], ['1756', '228'], ['1694', '200'], ['1694', '200'], ['1613', '160'], ['1609', '156'], ['1609', '156'], ['1603', '153'], ['1599', '149'], ['1591', '142'], ['1588', '137'], ['1585', '131'], ['1584', '128'], ['1584', '125'], ['1584', '122'], ['1585', '120'], ['1585', '120'], ['1585', '119'], ['1586', '117'], ['1587', '117'], ['1588', '117'], ['1594', '111'], ['1598', '107'], ['1602', '104'], ['1605', '102'], ['1607', '101'], ['1609', '100'], ['1610', '99'], ['1612', '98'], ['1614', '97'], ['1617', '97'], ['1625', '96'], ['1632', '96'], ['1643', '95'], ['1651', '92'], ['1658', '89'], ['1658', '89'], ['1675', '80'], ['1683', '76'], ['1695', '70'], ['1701', '67'], ['1701', '67'], ['1711', '62'], ['1723', '57'], ['1727', '56'], ['1727', '56'], ['1729', '55'], ['1731', '54'], ['1731', '53'], ['1731', '53'], ['1732', '52'], ['1732', '51'], ['1732', '51'], ['1732', '51'], ['1733', '51'], ['1733', '50'], ['1733', '50'], ['1734', '50'], ['1734', '49'], ['1735', '49'], ['1735', '48'], ['1735', '48'], ['1735', '47'], ['1735', '47'], ['1735', '47'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1735', '46'], ['1734', '47'], ['1733', '48'], ['1732', '48'], ['1730', '49'], ['1730', '50'], ['1729', '50'], ['1728', '51'], ['1727', '51'], ['1727', '51'], ['1727', '52'], ['1727', '52'], ['1727', '52'], ['1727', '52'], ['1727', '52'], ['1727', '53'], ['1727', '53'], ['1728', '54'], ['1728', '55'], ['1730', '58'], ['1731', '60'], ['1734', '62'], ['1735', '64'], ['1738', '66'], ['1741', '69'], ['1751', '74'], ['1753', '74'], ['1764', '78'], ['1768', '80'], ['1776', '81'], ['1781', '78'], ['1805', '78'], ['1840', '83'], ['1888', '94'], ['1935', '94'], ['1940', '95'], ['1950', '96'], ['1963', '97'], ['1970', '95'], ['1975', '95'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1976', '96'], ['1977', '98'], ['1978', '102'], ['1978', '102'], ['1981', '112'], ['1984', '122'], ['1988', '133'], ['1991', '138'], ['1994', '141'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '144'], ['1995', '143'], ['1995', '144'], ['1997', '142'], ['2002', '141'], ['2009', '142'], ['2029', '142'], ['2056', '144'], ['2075', '141'], ['2098', '140'], ['2157', '144'], ['2209', '148'], ['2251', '151'], ['2299', '160'], ['2341', '165'], ['2369', '168'], ['2462', '184'], ['2523', '199'], ['2580', '210'], ['2613', '215'], ['2613', '215'], ['2663', '234'], ['2666', '234'], ['2674', '236'], ['2678', '236'], ['2680', '236'], ['2680', '236'], ['2680', '236'], ['2679', '236'], ['2679', '236'], ['2679', '236'], ['2679', '236'], ['2679', '236'], ['2679', '236'], ['2678', '236'], ['2678', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2677', '236'], ['2676', '236'], ['2675', '236'], ['2674', '236'], ['2672', '235'], ['2667', '235'], ['2667', '235'], ['2660', '232'], ['2652', '231'], ['2635', '230'], ['2610', '227'], ['2575', '224'], ['2463', '209'], ['2387', '199'], ['2302', '192'], ['2144', '175'], ['2011', '168'], ['1732', '147'], ['1621', '132'], ['1341', '128'], ['1158', '126'], ['970', '123'], ['885', '121'], ['755', '117'], ['755', '117'], ['662', '103'], ['616', '97'], ['616', '97'], ['589', '98'], ['584', '98'], ['584', '98'], ['580', '98'], ['580', '98'], ['580', '98'], ['582', '98'], ['584', '98'], ['584', '98'], ['586', '98'], ['587', '98'], ['588', '98'], ['589', '98'], ['590', '98'], ['591', '98'], ['593', '97'], ['597', '97'], ['600', '97'], ['604', '97'], ['613', '96'], ['621', '96'], ['638', '92'], ['652', '89'], ['706', '79'], ['741', '73'], ['853', '58'], ['933', '49'], ['976', '40'], ['1017', '30'], ['1051', '20'], ['1084', '5'], ['1116', '0'], ['1186', '0'], ['1227', '0'], ['1282', '0'], ['1305', '0'], ['1322', '0'], ['1335', '0'], ['1339', '0'], ['1342', '0'], ['1344', '0'], ['1347', '0'], ['1348', '0'], ['1348', '0'], ['1349', '0'], ['1352', '0'], ['1356', '0'], ['1361', '0'], ['1369', '0'], ['1373', '0'], ['1382', '0'], ['1400', '0'], ['1412', '0'], ['1433', '0'], ['1465', '0'], ['1505', '0'], ['1525', '0'], ['1566', '0'], ['1588', '0'], ['1612', '1'], ['1619', '2'], ['1621', '2'], ['1621', '3'], ['1620', '4'], ['1616', '6'], ['1609', '10'], ['1594', '16'], ['1572', '24'], ['1558', '31'], ['1543', '39'], ['1528', '47'], ['1514', '53'], ['1484', '59'], ['1473', '64'], ['1453', '68'], ['1439', '70'], ['1421', '73'], ['1413', '76'], ['1400', '80'], ['1392', '82'], ['1380', '85'], ['1371', '86'], ['1359', '87'], ['1352', '87'], ['1346', '88'], ['1343', '88'], ['1341', '89'], ['1339', '89'], ['1337', '89'], ['1336', '89'], ['1333', '89'], ['1331', '88'], ['1326', '88'], ['1318', '88'], ['1314', '88'], ['1312', '88'], ['1312', '88'], ['1312', '88'], ['1311', '88'], ['1311', '87'], ['1311', '87'], ['1310', '87'], ['1307', '85'], ['1302', '83'], ['1296', '80'], ['1287', '76'], ['1279', '75'], ['1268', '75'], ['1254', '75'], ['1231', '74'], ['1209', '76'], ['1180', '82'], ['1168', '82'], ['1146', '83'], ['1130', '83'], ['1110', '83'], ['1099', '83'], ['1091', '83'], ['1080', '83'], ['1075', '83'], ['1071', '83'], ['1068', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1066', '83'], ['1068', '83'], ['1074', '82'], ['1077', '82'], ['1088', '80'], ['1100', '79'], ['1120', '77'], ['1132', '74'], ['1159', '69'], ['1181', '68'], ['1219', '68'], ['1238', '67'], ['1258', '66'], ['1269', '65'], ['1278', '65'], ['1286', '65'], ['1289', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1290', '65'], ['1291', '65'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1291', '64'], ['1290', '64'], ['1290', '64'], ['1289', '65'], ['1287', '65'], ['1284', '65'], ['1280', '66'], ['1272', '66'], ['1263', '66'], ['1250', '66'], ['1243', '64'], ['1224', '62'], ['1215', '63'], ['1194', '65'], ['1168', '66'], ['1122', '66'], ['1103', '69'], ['1080', '69'], ['1062', '69'], ['1046', '69'], ['1028', '69'], ['1019', '69'], ['1009', '69'], ['1006', '69'], ['1003', '69'], ['1001', '69'], ['998', '69'], ['996', '69'], ['993', '69'], ['991', '69'], ['986', '69'], ['980', '70'], ['975', '70'], ['971', '70'], ['969', '70'], ['967', '70'], ['967', '70'], ['966', '70'], ['965', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['964', '70'], ['963', '70'], ['963', '70'], ['963', '70'], ['964', '71'], ['965', '72'], ['966', '74'], ['966', '75'], ['967', '77'], ['968', '80'], ['969', '84'], ['969', '95'], ['969', '104'], ['968', '117'], ['968', '117'], ['968', '138'], ['968', '152'], ['971', '176'], ['972', '195'], ['972', '226'], ['971', '247'], ['969', '278'], ['967', '297'], ['964', '320'], ['963', '334'], ['961', '353'], ['960', '362'], ['960', '370'], ['960', '378'], ['960', '383'], ['960', '388'], ['960', '390'], ['960', '392'], ['960', '393'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '394'], ['960', '393']]




 

#goal to plot the points in linear time, based on occurence
def get_movement(dataset):
	'''
	{
		point 1:{
			x: "",
			y: "",
			occurence:{
				num_of_occurences: 1,
				start: 1,
				end: 54
			}
		}
	}
	'''
	pointDict = {}

	Preveus_Point = [0,0]
	Preveus_String = None

	Point_Counter = 0

	for cord in dataset:
		first_string = f"Point  {Point_Counter}" 

		#first add the first point
		if len(pointDict) == 0:

			pointDict[first_string] = {'x': int(cord[0]),\
										'y': int(cord[1]),\
										'occurence': {
											"num_of_occurences":1,\
											"start":Point_Counter,\
											"end":Point_Counter
										}}

			#update the previous points
			Preveus_Point = cord[0], cord[1]

			#update the key name of the previous string so we can access it on the next iteration
			Preveus_String = first_string

			#finally update the point counter
			Point_Counter += 1

			continue


		#if the next cords are the same as the previouse cords
		if (cord[0], cord[1]) == (Preveus_Point[0], Preveus_Point[1]):

			#update the occurance 
			pointDict[Preveus_String]['occurence']['num_of_occurences'] +=1

			#update the end
			pointDict[Preveus_String]['occurence']['end'] += 1


		else:


			#add the new point
			pointDict[first_string] = {'x': int(cord[0]),\
										'y': int(cord[1]),\
										'occurence': {
											"num_of_occurences":1,\
											"start":Point_Counter,\
											"end":Point_Counter
										}}

			#update the previous points
			Preveus_Point = cord[0], cord[1]

			#update the key name of the previous string so we can access it on the next iteration
			Preveus_String = first_string


		#finally update the point counter
		Point_Counter += 1


	return pointDict





#make an json file of point arrays without the pauses 
def build_the_dataset(data_info, dataset):

	'''
	@set accuraccy

		space_range: how long was the mouse in one position
		move_buffer: how long the mouse was in motion

	'''
	movement_arrays = []

	#this is the space buffer range
	space_buffer = list(range(4,500))

	#move buffer range
	move_buffer = list(range(10,500))

	#end of the space
	temp_end = 0


	#get highest points
	for x in data_info:
		if data_info[x]['occurence']['num_of_occurences'] in space_buffer:
			
			#print(f"start {data_info[x]['occurence']['start']}")
			#print(f"end {data_info[x]['occurence']['end']}")


			#if we pass the first space
			if temp_end != 0:
				#print(temp_end, data_info[x]['occurence']['start'])
				if len(dataset[temp_end:data_info[x]['occurence']['start']]) in move_buffer:
					movement_arrays.append(dataset[temp_end:data_info[x]['occurence']['start']])

			#update the temp end
			temp_end = data_info[x]['occurence']['end']

	return movement_arrays


pf = parseFile(file)
dataset = pf.dataset

t = get_movement(dataset)
a = build_the_dataset(t, dataset)

#plot_lines(a)


